DROP DATABASE IF EXISTS RANDOM_TEST;
CREATE DATABASE RANDOM_TEST;
USE RANDOM_TEST;
DROP TABLE IF EXISTS T1;
CREATE TABLE T1(C1 INT, C2 INT, C3 INT, C4 INT);
INSERT INTO T1 VALUES(9, 6, 2, 0);
INSERT INTO T1 VALUES(0, 4, 5, 3);
INSERT INTO T1 VALUES(8, 4, 5, 2);
INSERT INTO T1 VALUES(0, 0, 8, 5);
INSERT INTO T1 VALUES(2, 4, 5, 6);
INSERT INTO T1 VALUES(8, 1, 0, 8);
INSERT INTO T1 VALUES(3, 3, 9, 5);
INSERT INTO T1 VALUES(9, 2, 3, 0);
INSERT INTO T1 VALUES(8, 8, 2, 0);
INSERT INTO T1 VALUES(2, 8, 3, 0);
SELECT * FROM T1;
DROP TABLE IF EXISTS T2;
CREATE TABLE T2(C1 INT, C2 INT, C3 INT, C4 INT);
INSERT INTO T2 VALUES(9, 5, 9, 3);
INSERT INTO T2 VALUES(9, 4, 1, 9);
INSERT INTO T2 VALUES(7, 1, 9, 3);
INSERT INTO T2 VALUES(4, 8, 8, 6);
INSERT INTO T2 VALUES(2, 3, 6, 1);
INSERT INTO T2 VALUES(1, 9, 1, 3);
INSERT INTO T2 VALUES(9, 5, 5, 1);
INSERT INTO T2 VALUES(5, 2, 6, 6);
INSERT INTO T2 VALUES(9, 7, 9, 8);
INSERT INTO T2 VALUES(2, 0, 0, 1);
SELECT * FROM T2;
EXPLAIN DELETE T1 FROM T2 T1, T1 T2 ;
DELETE T1 FROM T2 T1, T1 T2 ;
EXPLAIN DELETE T1 FROM T1 T1, T2 T2 WHERE T1.C1 > T1.C4;
DELETE T1 FROM T1 T1, T2 T2 WHERE T1.C1 > T1.C4;
EXPLAIN DELETE T1 FROM T1 T1, T1 T2 WHERE (T1.C3) > T2.C3;
DELETE T1 FROM T1 T1, T1 T2 WHERE (T1.C3) > T2.C3;
EXPLAIN DELETE T1 FROM T2 T1, T1 T2 ;
DELETE T1 FROM T2 T1, T1 T2 ;
EXPLAIN DELETE T1 FROM T1 T1, T1 T2, T2 T3, T2 T4, T1 T5 INNER JOIN T2 T6 ON T6.C3 != (T6.C2) ;
DELETE T1 FROM T1 T1, T1 T2, T2 T3, T2 T4, T1 T5 INNER JOIN T2 T6 ON T6.C3 != (T6.C2) ;
EXPLAIN DELETE T1 FROM T2 T1, T2 T2 WHERE T2.C3 NOT BETWEEN T1.C1 AND T1.C3;
DELETE T1 FROM T2 T1, T2 T2 WHERE T2.C3 NOT BETWEEN T1.C1 AND T1.C3;
EXPLAIN DELETE T1 FROM T2 T1, T2 T2, T2 T3 WHERE (((T1.C1) = T2.C2 AND (T3.C4) != (T2.C1)) AND (T1.C3) IS NOT NULL);
DELETE T1 FROM T2 T1, T2 T2, T2 T3 WHERE (((T1.C1) = T2.C2 AND (T3.C4) != (T2.C1)) AND (T1.C3) IS NOT NULL);
EXPLAIN DELETE T1 FROM T1 T1, T1 T2 FULL JOIN (T1 T3 RIGHT JOIN T1 T4 ON (T4.C2 > (T3.C2) AND (T3.C3) = (T4.C2))) ON ((T2.C3 > (T2.C2) AND (T4.C3) IS NULL) AND (T4.C4) <= T3.C4) AND (T3.C3) >= (T4.C2) OR (T2.C1) IS NULL WHERE ((((T3.C4) <= T3.C3 OR (T1.C2) = (T3.C2)) OR (T1.C2) <= (T3.C3)) OR (T1.C4) NOT BETWEEN T3.C3 AND (T3.C4) AND T2.C2 >= T1.C2 OR T3.C2 >= T3.C4);
DELETE T1 FROM T1 T1, T1 T2 FULL JOIN (T1 T3 RIGHT JOIN T1 T4 ON (T4.C2 > (T3.C2) AND (T3.C3) = (T4.C2))) ON ((T2.C3 > (T2.C2) AND (T4.C3) IS NULL) AND (T4.C4) <= T3.C4) AND (T3.C3) >= (T4.C2) OR (T2.C1) IS NULL WHERE ((((T3.C4) <= T3.C3 OR (T1.C2) = (T3.C2)) OR (T1.C2) <= (T3.C3)) OR (T1.C4) NOT BETWEEN T3.C3 AND (T3.C4) AND T2.C2 >= T1.C2 OR T3.C2 >= T3.C4);
EXPLAIN DELETE T1 FROM T2 T1, T1 T2, T2 T3 ;
DELETE T1 FROM T2 T1, T1 T2, T2 T3 ;
EXPLAIN DELETE T1 FROM T1 T1, T1 T2, T1 T3, T2 T4, T1 T5 WHERE ((((T1.C2) != (T5.C2) OR (T3.C2) = (T1.C2)) OR T3.C1 IS NOT NULL) OR T3.C4 = (T5.C2));
DELETE T1 FROM T1 T1, T1 T2, T1 T3, T2 T4, T1 T5 WHERE ((((T1.C2) != (T5.C2) OR (T3.C2) = (T1.C2)) OR T3.C1 IS NOT NULL) OR T3.C4 = (T5.C2));
EXPLAIN DELETE T1 FROM T1 T1, T2 T2 ;
DELETE T1 FROM T1 T1, T2 T2 ;
EXPLAIN DELETE T1 FROM T1 T1, T2 T2, T2 T3 FULL JOIN T2 T4 ON T3.C2 != (T4.C2) OR T3.C4 IS NOT NULL ;
DELETE T1 FROM T1 T1, T2 T2, T2 T3 FULL JOIN T2 T4 ON T3.C2 != (T4.C2) OR T3.C4 IS NOT NULL ;
EXPLAIN DELETE T1 FROM T1 T1, T1 T2, T1 T3, T1 T4, T1 T5 LEFT JOIN (T1 T6 INNER JOIN T1 T7 ON T6.C1 IS NULL OR T6.C2 >= T7.C2 OR T7.C4 BETWEEN (T6.C4) AND (T6.C3) OR (T7.C4) NOT BETWEEN T6.C2 AND (T7.C4)) ON (T5.C1 < (T5.C4) OR (T7.C1) = (T7.C3)) LEFT JOIN (T1 T8 RIGHT JOIN T1 T9 ON (T8.C1) IS NULL) ON (T7.C3) IS NOT NULL WHERE (T9.C1 = T7.C4 OR T3.C1 BETWEEN (T3.C4) AND T8.C4) AND T6.C1 >= (T1.C1);
DELETE T1 FROM T1 T1, T1 T2, T1 T3, T1 T4, T1 T5 LEFT JOIN (T1 T6 INNER JOIN T1 T7 ON T6.C1 IS NULL OR T6.C2 >= T7.C2 OR T7.C4 BETWEEN (T6.C4) AND (T6.C3) OR (T7.C4) NOT BETWEEN T6.C2 AND (T7.C4)) ON (T5.C1 < (T5.C4) OR (T7.C1) = (T7.C3)) LEFT JOIN (T1 T8 RIGHT JOIN T1 T9 ON (T8.C1) IS NULL) ON (T7.C3) IS NOT NULL WHERE (T9.C1 = T7.C4 OR T3.C1 BETWEEN (T3.C4) AND T8.C4) AND T6.C1 >= (T1.C1);
EXPLAIN DELETE T1 FROM T2 T1, T2 T2 WHERE (T2.C2 IS NULL AND (T2.C3) <= T1.C3);
DELETE T1 FROM T2 T1, T2 T2 WHERE (T2.C2 IS NULL AND (T2.C3) <= T1.C3);
EXPLAIN DELETE T1 FROM T1 T1, T2 T2 ;
DELETE T1 FROM T1 T1, T2 T2 ;
EXPLAIN DELETE T1 FROM T2 T1, T1 T2, T2 T3 ;
DELETE T1 FROM T2 T1, T1 T2, T2 T3 ;
EXPLAIN DELETE T1 FROM T1 T1, T2 T2, T2 T3 ;
DELETE T1 FROM T1 T1, T2 T2, T2 T3 ;
EXPLAIN DELETE T1 FROM T2 T1, T1 T2 WHERE T1.C2 IS NULL;
DELETE T1 FROM T2 T1, T1 T2 WHERE T1.C2 IS NULL;
EXPLAIN DELETE T1 FROM T2 T1, T1 T2 RIGHT JOIN T1 T3 ON (T2.C2 = (T3.C2) OR (T3.C2) = (T2.C3)) INNER JOIN (T2 T4 INNER JOIN T2 T5 ON T5.C4 >= (T4.C1)) ON (((T5.C3 = T2.C1 AND (T2.C3) > (T3.C2)) AND (T5.C2) > T2.C4) AND (T3.C2) > (T3.C3)), T1 T6 LEFT JOIN (T1 T7 LEFT JOIN T1 T8 ON ((T7.C3) IS NULL OR (T7.C1) > T7.C4) INNER JOIN T2 T9 ON (T8.C3 < (T8.C1) OR T7.C1 < T9.C4) OR T8.C4 IS NOT NULL) ON (T6.C1) = T8.C2 RIGHT JOIN T1 T10 ON T9.C4 NOT BETWEEN (T9.C2) AND (T8.C3) ;
DELETE T1 FROM T2 T1, T1 T2 RIGHT JOIN T1 T3 ON (T2.C2 = (T3.C2) OR (T3.C2) = (T2.C3)) INNER JOIN (T2 T4 INNER JOIN T2 T5 ON T5.C4 >= (T4.C1)) ON (((T5.C3 = T2.C1 AND (T2.C3) > (T3.C2)) AND (T5.C2) > T2.C4) AND (T3.C2) > (T3.C3)), T1 T6 LEFT JOIN (T1 T7 LEFT JOIN T1 T8 ON ((T7.C3) IS NULL OR (T7.C1) > T7.C4) INNER JOIN T2 T9 ON (T8.C3 < (T8.C1) OR T7.C1 < T9.C4) OR T8.C4 IS NOT NULL) ON (T6.C1) = T8.C2 RIGHT JOIN T1 T10 ON T9.C4 NOT BETWEEN (T9.C2) AND (T8.C3) ;
EXPLAIN DELETE T1 FROM T1 T1, T2 T2, T2 T3 FULL JOIN T2 T4 ON (T4.C1) >= (T3.C4) ;
DELETE T1 FROM T1 T1, T2 T2, T2 T3 FULL JOIN T2 T4 ON (T4.C1) >= (T3.C4) ;
